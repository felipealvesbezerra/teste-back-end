<!DOCTYPE html>

<html>

<head>
  <meta charset="UTF-8">
  <title>CRUD</title>
  <link rel="stylesheet" type="text/css" href="./styles.css">
  <!-- Adicionando JQuery -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

<!-- Adicionando Javascript -->
<script>

$(document).ready(function() {

  function limpa_formulário_cep() {
      // Limpa valores do formulário de cep.
      $("#rua").val("");
      $("#bairro").val("");
      $("#cidade").val("");
      $("#uf").val("");
      $("#ibge").val("");
  }
  
  //Quando o campo cep perde o foco.
  $("#cep").blur(function() {

      //Nova variável "cep" somente com dígitos.
      var cep = $(this).val().replace(/\D/g, '');

      //Verifica se campo cep possui valor informado.
      if (cep != "") {

          //Expressão regular para validar o CEP.
          var validacep = /^[0-9]{8}$/;

          //Valida o formato do CEP.
          if(validacep.test(cep)) {

              //Preenche os campos com "..." enquanto consulta webservice.
              $("#rua").val("...");
              $("#bairro").val("...");
              $("#cidade").val("...");
              $("#uf").val("...");
              $("#ibge").val("...");

              //Consulta o webservice viacep.com.br/
              $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {

                  if (!("erro" in dados)) {
                      //Atualiza os campos com os valores da consulta.
                      $("#rua").val(dados.logradouro);
                      $("#bairro").val(dados.bairro);
                      $("#cidade").val(dados.localidade);
                      $("#uf").val(dados.uf);
                      $("#ibge").val(dados.ibge);
                  } //end if.
                  else {
                      //CEP pesquisado não foi encontrado.
                      limpa_formulário_cep();
                      alert("CEP não encontrado.");
                  }
              });
          } //end if.
          else {
              //cep é inválido.
              limpa_formulário_cep();
              alert("Formato de CEP inválido.");
          }
      } //end if.
      else {
          //cep sem valor, limpa formulário.
          limpa_formulário_cep();
      }
  });
});

</script>
</head>

<body>
  <section class="form-section">
  
    <h1>Registrar</h1>

    
      <form action="/show" method="POST">
        <div class="input-block">
          <table class="tabela-home">
          <tr>
            <td>
              <label for="">Nome</label>
              <input class="inp1" type="text" name="name" required><br>
            </td>
            <td>  
            <label for="">Sobrenome</label>
            <input type="text" name="surname" required><br>
            </td>
          </tr>

          <tr>
            <td>
              <div class="label-genero"><label for="">Sexo</label></div>
              <select class="input-block" name="sex" required>
                <option value="">Selecione...</option>
                <option value="Masculino">Masculino</option>
                <option value="Feminino">Feminino</option>
                <option value="Não binário">Não binário</option>
              </select><br>
            </td>
            <td>
              <label for="">Idade</label>
              <input type="number" name="age" required><br>
            </td>
          </tr>
          <tr>
            <td>
              <label for="">Telefone</label>
              <input type="text" name="phone" required><br>
            </td>
              <td>
                <label for="">Email</label>
                <input type="email" name="email" required><br>
              </td>
            </tr>
            <tr>
              <td>
                <label for="">Linkedin</label>
                <input type="text" name="linkedin" required><br>
              </td>
              <td>
                <label for="">Identidade (RG, CNH..)</label>
                <input type="text" name="rg" required><br>
              </td>
            </tr>
            <tr>
              <td>
                <label for="">CEP</label>
                <input name="cep" type="text" id="cep"/><br />
              </td> 
              <td>
                <label for="">Rua</label>
                <input name="rua" type="text" id="rua"/><br />
              </td>
            </tr>
            <tr>
              <td>
                <label for="">Número</label>
                <input name="number" type="text"/><br>
              </td>
              <td> 
                <label for="">Bairro</label> 
                <input name="bairro" type="text" id="bairro"/><br />
              </td>
            </tr>
            <tr>
              <td>
                <label for="">Cidade</label>
                <input name="cidade" type="text" id="cidade"/><br />
              </td>
              <td>
                <label for="">Estado</label>
                <input name="uf" type="text" id="uf"/><br />
              </td>
            </tr>
          </table>
        </div>
          
        <button class="btn-login" type="submit">Cadastrar</button><br>
        <button class="btn-login"><a href="/show">Visualizar dados já cadastrados</a></button>
      </form>
  </div>

</section>

  <!-- importações -->
  <script src="../app.js"></script>
  <script src="../server.js"></script>
</body>

</html>